"use strict";(()=>{var e={};e.id=577,e.ids=[577],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},8725:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>d});var s=r(9303),i=r(8716),n=r(670),o=r(7070),u=r(9498),p=r(7986);async function c(e,t,r,a,s,i="*"){let n=(0,p.ot)(r),o=e.from(t).select(i,{count:"exact"});a&&(o=a(o)),s?.column&&(o=o.order(s.column,{ascending:s.ascending??!0,nullsFirst:s.nullsFirst??!1})),o=o.range(n.offset,n.offset+n.limit-1);let{data:u,error:c,count:d}=await o;if(c)throw c;return{items:u??[],meta:(0,p.CE)(d??0,n)}}async function d(e){let t=new URL(e.url),r=t.searchParams.get("page"),a=t.searchParams.get("pageSize"),s=t.searchParams.get("q")?.trim(),i=t.searchParams.get("status")?.trim(),n=(0,u.eI)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY);try{let{items:e,meta:t}=await c(n,"products",{page:r,pageSize:a,maxPageSize:100,defaultPageSize:20},e=>{let t=e.eq("status",i||"active");return s&&(t=t.or(`title.ilike.%${s}%,description.ilike.%${s}%`)),t},{column:"created_at",ascending:!1},"id, title, price, currency, stock, status, seller_id, created_at, updated_at, sellers!inner (slug, brand_name)");return o.NextResponse.json({items:e,meta:t})}catch(e){return console.error("Error fetching products:",e),o.NextResponse.json({error:"Failed to fetch products"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/products/route",pathname:"/api/admin/products",filename:"route",bundlePath:"app/api/admin/products/route"},resolvedPagePath:"D:\\pots.ro\\app\\api\\admin\\products\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=l,f="/api/admin/products/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},7986:(e,t,r)=>{function a({page:e,pageSize:t,maxPageSize:r=60,defaultPageSize:a=24}){let n=i(s(e,1),1,1e6),o=i(s(t,a),1,r);return{page:n,pageSize:o,limit:o,offset:(n-1)*o}}function s(e,t){if(null==e)return t;let r="string"==typeof e?parseInt(e,10):Math.trunc(e);return Number.isFinite(r)?r:t}function i(e,t,r){return Math.max(t,Math.min(r,e))}function n(e,t){let r=Math.max(1,Math.ceil(e/t.pageSize)),a=Math.min(t.page,r);return{page:a,pageSize:t.pageSize,totalItems:e,totalPages:r,hasPrev:a>1,hasNext:a<r}}r.d(t,{CE:()=>n,ot:()=>a})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972,498],()=>r(8725));module.exports=a})();