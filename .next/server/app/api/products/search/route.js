"use strict";(()=>{var e={};e.id=778,e.ids=[778],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},2112:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{GET:()=>l});var s=t(9303),n=t(8716),o=t(670),i=t(7070),u=t(9498),p=t(7986);async function c(e,r,t,a={},s,n){let o=(0,p.ot)(t),i=e.rpc(r,a,{count:"exact"}),{count:u,error:c}=await i;if(c)throw c;let l=e.rpc(r,a,{count:"exact"});s?.column&&(l=l.order?.(s.column,{ascending:s.ascending??!0,nullsFirst:s.nullsFirst??!1})??l),l=l.range?.(o.offset,o.offset+o.limit-1)??l;let{data:d,error:h}=await l;if(h)throw h;return{items:d??[],meta:(0,p.CE)(u??0,o)}}async function l(e){let r=new URL(e.url),t=r.searchParams.get("page"),a=r.searchParams.get("pageSize"),s=r.searchParams.get("q")||null,n=(0,u.eI)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY);try{let{items:e,meta:r}=await c(n,"rpc_products_active",{page:t,pageSize:a,defaultPageSize:24,maxPageSize:60},{search:s},{column:"created_at",ascending:!1});return i.NextResponse.json({items:e,meta:r})}catch(e){return console.error("RPC search error:",e),i.NextResponse.json({error:"Failed to search products"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/products/search/route",pathname:"/api/products/search",filename:"route",bundlePath:"app/api/products/search/route"},resolvedPagePath:"D:\\pots.ro\\app\\api\\products\\search\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g}=d,x="/api/products/search/route";function f(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},7986:(e,r,t)=>{function a({page:e,pageSize:r,maxPageSize:t=60,defaultPageSize:a=24}){let o=n(s(e,1),1,1e6),i=n(s(r,a),1,t);return{page:o,pageSize:i,limit:i,offset:(o-1)*i}}function s(e,r){if(null==e)return r;let t="string"==typeof e?parseInt(e,10):Math.trunc(e);return Number.isFinite(t)?t:r}function n(e,r,t){return Math.max(r,Math.min(t,e))}function o(e,r){let t=Math.max(1,Math.ceil(e/r.pageSize)),a=Math.min(r.page,t);return{page:a,pageSize:r.pageSize,totalItems:e,totalPages:t,hasPrev:a>1,hasNext:a<t}}t.d(r,{CE:()=>o,ot:()=>a})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,972,498],()=>t(2112));module.exports=a})();